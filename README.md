# **Well-Log Lithology Classification (XGBoost + SHAP)**

**–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ª–∏—Ç–æ–ª–æ–≥–∏–∏ –ø–æ –¥–∞–Ω–Ω—ã–º –ì–ò–° | Accuracy: 90.5%**

---

## üìå **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞**

–ú–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π **–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–∏—Ç–æ–ª–æ–≥–∏–∏ –ø–æ –¥–∞–Ω–Ω—ã–º –ì–ò–°** (well logs).
–ü—Ä–æ–µ–∫—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ –∑–∞–¥–∞—á–∏ –Ω–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–æ–π –æ—Ç—Ä–∞—Å–ª–∏ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –∫–∞—Ä–æ—Ç–∞–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —É—Å–∫–æ—Ä–µ–Ω–∏–µ –≥–µ–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∏ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ—Ä–æ–¥.

---

## üéØ **–¶–µ–ª—å**

–°–æ–∑–¥–∞—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π ML-–ø–∞–π–ø–ª–∞–π–Ω, –∫–æ—Ç–æ—Ä—ã–π:

* –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ –Ω–∞–±–æ—Ä –ì–ò–°-–∫—Ä–∏–≤—ã—Ö;
* –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (–æ—á–∏—Å—Ç–∫–∞ ‚Üí —Ñ–∏—á–µ—Ä–∏–Ω–≥ ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è ‚Üí –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤);
* –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ª–∏—Ç–æ—Ç–∏–ø–æ–≤;
* –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç (SHAP);
* –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫—É—é —Ç–æ—á–Ω–æ—Å—Ç—å (90%+).

---

## üõ† **–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏**

* **Python**, Pandas, NumPy
* **Scikit-learn**, **XGBoost**, CatBoost
* **SHAP**
* Matplotlib / Seaborn
* Jupyter Notebook

---

## üìÇ **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**

```
‚îú‚îÄ‚îÄ notebooks/               # –ò—Å—Ö–æ–¥–Ω—ã–µ –Ω–æ—É—Ç–±—É–∫–∏ (EDA, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –º–æ–¥–µ–ª–∏)
‚îú‚îÄ‚îÄ src/                     # –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ preprocessing.py
‚îÇ   ‚îú‚îÄ‚îÄ train.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ data/                    # –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (–±–µ–∑ —Å—ã—Ä—å—è)
‚îú‚îÄ‚îÄ models/                  # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ reports/                 # –ì—Ä–∞—Ñ–∏–∫–∏, –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ feature_importance.png
‚îÇ   ‚îú‚îÄ‚îÄ shap_summary.png
‚îÇ   ‚îî‚îÄ‚îÄ confusion_matrix.png
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

---

## üìä **–î–∞–Ω–Ω—ã–µ**

–í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã well-log –¥–∞–Ω–Ω—ã–µ (–ì–ò–°):

* GR
* RHOB
* NPHI
* DT
* Resistivity
* –∏ –¥—Ä.

–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç:

* —É–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤;
* –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤;
* –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫—Ä–∏–≤—ã—Ö;
* –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é;
* —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–≥—Ä–∞–¥–∏–µ–Ω—Ç—ã, —Ä–∞–∑–Ω–æ—Å—Ç–∏, —Å–≥–ª–∞–∂–µ–Ω–Ω—ã–µ –∫—Ä–∏–≤—ã–µ).

---

## üß† **–ú–µ—Ç–æ–¥ / –ü–æ–¥—Ö–æ–¥**

### **1. EDA**

* –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π;
* –æ—Ü–µ–Ω–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π;
* —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π.

### **2. Feature Engineering**

* —Å–æ–∑–¥–∞–Ω–∏–µ 8+ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤;
* —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤;
* —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π feature selection.

### **3. –ú–æ–¥–µ–ª—å**

* **XGBoost** (–æ—Å–Ω–æ–≤–Ω–∞—è)
* CatBoost –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
* GridSearch –ø–æ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º

### **4. –í–∞–ª–∏–¥–∞—Ü–∏—è**

* stratified train-test split;
* –∫–æ–Ω—Ç—Ä–æ–ª—å –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ classes;
* cross-validation.

---

## üìà **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã**

### **Accuracy: 90.5%**

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:

(–¥–æ–±–∞–≤—å –∫–∞—Ä—Ç–∏–Ω–∫–∏ –≤ /reports –∏ –≤—Å—Ç–∞–≤—å —Å—Å—ã–ª–∫–∏)

* **Feature Importance**
  ![](reports/feature_importance.png)

* **SHAP Summary Plot**
  ![](reports/shap_summary.png)

* **Confusion Matrix**
  ![](reports/confusion_matrix.png)

---

## üß© **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ (SHAP)**

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω SHAP –¥–ª—è –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –≤–∫–ª–∞–¥–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞:

* GR –∏ RHOB ‚Äî –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä—ã
* –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ —É—Å–∏–ª–∏–ª–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–µ—Å—á–∞–Ω—ã—Ö/–≥–ª–∏–Ω–∏—Å—Ç—ã—Ö –ª–∏—Ç–æ–ª–æ–≥–∏–π
* –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è SHAP –ø–æ–º–æ–≥–∞–µ—Ç –≥–µ–æ–ª–æ–≥–∞–º –ø–æ–Ω–∏–º–∞—Ç—å ‚Äú–ø–æ—á–µ–º—É –º–æ–¥–µ–ª—å –¥—É–º–∞–µ—Ç —Ç–∞–∫‚Äù

---

## üõ† **–ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å**

### 1) –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```
git clone https://github.com/damir-latypov/well-log-lithology-classification
cd well-log-lithology-classification
```

### 2) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```
pip install -r requirements.txt
```

### 3) –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è:

```
python src/train.py
```

### 4) –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏:

```
python src/predict.py --input data/sample.csv
```

---

## üíº **–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å**

* —Å–æ–∫—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è —Ä—É—á–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –ì–ò–° –Ω–∞ **30‚Äì50%**
* –ø–æ–≤—ã—à–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –∫–∞—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
* –ª–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–∞–π–ø–ª–∞–π–Ω—ã –≥–µ–æ–ª–æ–≥–æ–≤/–ì–¢–ò
* –ø—Ä–∏–º–µ–Ω–∏–º–æ –≤ –±—É—Ä–µ–Ω–∏–∏, –≥–µ–æ–ª–æ–≥–∏–∏, petrophysics, subsurface analytics

---

## üöÄ **–ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è**

* –¥–æ–±–∞–≤–∏—Ç—å –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (TabNet / MLP)
* –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –±–æ–ª—å—à–µ–º —á–∏—Å–ª–µ —Å–∫–≤–∞–∂–∏–Ω
* –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –º–æ–¥–µ–ª—è–º–∏ –§–ï–°
* –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è inference –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## üì¨ –ö–æ–Ω—Ç–∞–∫—Ç—ã

**Author:** Damir Latypov
GitHub: [https://github.com/damir-latypov](https://github.com/damir-latypov)
Email: [damir_latypov_98@mail.ru](mailto:damir_latypov_98@mail.ru)
